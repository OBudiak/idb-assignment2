## Опис проєкту
Цей проєкт демонструє оптимізацію складного SQL-запиту в MySQL. Мета — показати поступове поліпшення продуктивності через рефакторинг, використання віконних функцій (CTE) та додавання індексів. Для кожної версії запиту порівнюються плани виконання (EXPLAIN).

## Структура
- **original_query.sql** – початковий “складний” запит із корельованими підзапитами.
- **step1_refactor.sql** – перший рефактор: CTE та віконні функції замість корельованих підзапитів.
- **step2_refactor.sql** – додавання/зміна індексів та оновлений запит із CTE.
- **query1.txt**, **query2.txt**, **query3.txt** – результати EXPLAIN для кожної версії запиту.
- **queries-optimization.pdf** – короткий опис зроблених кроків, обґрунтування оптимізацій і висновки.

## Ключові кроки оптимізації
1. **Оригінальний запит**  
   - Повні сканування таблиці в кожному підзапиті → низька ефективність.

2. **Рефакторинг з CTE і віконними функціями**  
   - Один прохід таблиці для розрахунку середнього значення та рангу → суттєве зменшення операцій вводу/виводу.

3. **Додавання індексів**  
   - Створено індекси на стовпцях (Year, MSRP) (або (Make, Year)).  
   - Пояснення: індекси допомагають уникнути повних сканувань, але при низькій селективності можуть викликати додаткові витрати на filesort.

## Використання
1. Виконати `original_query.sql`, додавши перед запитом `EXPLAIN` → зберегти в `query1.txt`.
2. Виконати `step1_refactor.sql` з `EXPLAIN` → зберегти в `query2.txt`.
3. Застосувати індекси з `step2_refactor.sql`, запустити оновлений запит із `EXPLAIN` → зберегти в `query3.txt`.
4. Ознайомитися з `queries-optimization.pdf` для детального пояснення та висновків.
